{{- if .Values.queues.videoWorker }}
apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: video-worker
  labels:
    {{- include "stereo-spot.labels" . | nindent 4 }}
    app: video-worker
spec:
  scaleTargetRef:
    name: video-worker
  minReplicaCount: {{ .Values.videoWorker.minReplicas }}
  maxReplicaCount: {{ .Values.videoWorker.maxReplicas }}
  triggers:
    - type: aws-sqs-queue
      authenticationRef:
        name: stereo-spot-aws-irsa
      metadata:
        queueURL: {{ .Values.queues.videoWorker }}
        queueLength: {{ .Values.videoWorker.queueLength | quote }}
        awsRegion: {{ .Values.global.awsRegion }}
{{- end }}
